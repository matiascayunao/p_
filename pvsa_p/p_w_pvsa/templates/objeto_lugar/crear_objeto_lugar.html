{# templates/objeto_lugar/crear_objeto_lugar.html #}
{% extends "base.html" %}
{% block content %}
<div class="container py-5" style="max-width: 820px;">

  <div class="mb-3 d-flex justify-content-between align-items-center gap-2">
    <a href="{% url 'detalle_lugar' lugar_id=lugar.id %}" class="btn btn-outline-secondary btn-sm">
      &laquo; Volver al lugar
    </a>
    <span class="badge rounded-pill text-bg-light border">
      Lugar: <strong class="ms-1">{{ lugar.nombre_del_lugar }}</strong>
    </span>
  </div>

  <div class="card border-0 shadow-sm rounded-4">
    <div class="card-body p-4 p-md-5">
      <h3 class="mb-1">Agregar objeto al lugar</h3>
      <p class="text-muted mb-4">Selecciona el tipo (marca/material) y define cantidad/estado.</p>

      <form method="post" novalidate>
        {% csrf_token %}

        {% if form.non_field_errors %}
          <div class="alert alert-danger">{{ form.non_field_errors|striptags }}</div>
        {% endif %}

        <div class="mb-3">
          <label class="form-label" for="{{ form.tipo_de_objeto.id_for_label }}">Tipo de objeto</label>
          <select
            name="{{ form.tipo_de_objeto.name }}"
            id="{{ form.tipo_de_objeto.id_for_label }}"
            class="form-select {% if form.tipo_de_objeto.errors %}is-invalid{% endif %}"
            required
          >
            {% for option in form.tipo_de_objeto.field.choices %}
              <option value="{{ option.0 }}"
                {% if form.tipo_de_objeto.value|stringformat:"s" == option.0|stringformat:"s" %}selected{% endif %}>
                {{ option.1 }}
              </option>
            {% endfor %}
          </select>
          {% if form.tipo_de_objeto.errors %}
            <div class="invalid-feedback">{{ form.tipo_de_objeto.errors|striptags }}</div>
          {% else %}
            <div class="form-text">Este combo representa Objeto + Marca + Material.</div>
          {% endif %}
        </div>

        <div class="row g-3">
          <div class="col-md-4">
            <label class="form-label" for="{{ form.cantidad.id_for_label }}">Cantidad</label>
            <input
              type="number"
              name="{{ form.cantidad.name }}"
              id="{{ form.cantidad.id_for_label }}"
              value="{{ form.cantidad.value|default_if_none:'' }}"
              class="form-control {% if form.cantidad.errors %}is-invalid{% endif %}"
              placeholder="Ej: 10"
              min="0"
              required
            >
            {% if form.cantidad.errors %}
              <div class="invalid-feedback">{{ form.cantidad.errors|striptags }}</div>
            {% endif %}
          </div>

          <div class="col-md-8">
            <label class="form-label" for="{{ form.estado.id_for_label }}">Estado</label>
            <select
              name="{{ form.estado.name }}"
              id="{{ form.estado.id_for_label }}"
              class="form-select {% if form.estado.errors %}is-invalid{% endif %}"
              required
            >
              {% for option in form.estado.field.choices %}
                <option value="{{ option.0 }}"
                  {% if form.estado.value|stringformat:"s" == option.0|stringformat:"s" %}selected{% endif %}>
                  {{ option.1 }}
                </option>
              {% endfor %}
            </select>
            {% if form.estado.errors %}
              <div class="invalid-feedback">{{ form.estado.errors|striptags }}</div>
            {% endif %}
          </div>
        </div>

        <div class="mt-3 mb-4">
          <label class="form-label" for="{{ form.detalle.id_for_label }}">Detalle (opcional)</label>
          <input
            type="text"
            name="{{ form.detalle.name }}"
            id="{{ form.detalle.id_for_label }}"
            value="{{ form.detalle.value|default_if_none:'' }}"
            class="form-control {% if form.detalle.errors %}is-invalid{% endif %}"
            placeholder="Ej: Falta revisión, caja dañada, etc."
          >
          {% if form.detalle.errors %}
            <div class="invalid-feedback">{{ form.detalle.errors|striptags }}</div>
          {% endif %}
        </div>

        <div class="d-flex flex-wrap gap-2">
          <button class="btn btn-primary" type="submit">Guardar</button>
          <a class="btn btn-outline-secondary" href="{% url 'detalle_lugar' lugar_id=lugar.id %}">Cancelar</a>
        </div>
      </form>
    </div>
  </div>
</div>
{% endblock %}
